<head>

    <style>
    #map {
        width: 100%;
        height: 100%;
        background-color: grey;
    }
    </style>
<script src="OpenLayers.js"></script>
    <script
    src="https://code.jquery.com/jquery-3.4.1.js"
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"></script>

    <script src="js/map.js" type="text/javascript"></script>

    <script>
        var geomap;
        $("document").ready(function() {
            geomap = new window.geomap("map");

            geomap.onmapclick(function(loc) {
                console.log('index.html map click');
                geomap.setCenter(loc.lat, loc.lon);
                loadImages(loc.lat, loc.lon);
            });

            var center = geomap.getCenter();
            loadImages(center.lat, center.lon);
        });

        function loadImages(lat, lng) {
            $.get({
                    //url: 'wc/list?nearby=39.76,-86.16,120',
                    url: 'wc/list?nearby=' + lat + ',' + lng + ',120',
                    success: function(data) {
                        
                        $("#cams").empty();
                        var cams = data.result.webcams;
                        for (var i = 0; i < cams.length; i++) {
                            var cam = cams[i];
                            var title = cam.title;
                            var preview = cam.image.current.preview;
                            //$("#cams").append("<img src='" + preview + "' title='" + title + "'></img>")

                            geomap.addMarker(cam.location.latitude, cam.location.longitude, cam.image.current.preview, cam.title);
                        }
                    }            
                });
        }
    </script>
</head>
<body>
    <div id="map">

    </div>
    <div id="cams">
    </div>
</body>